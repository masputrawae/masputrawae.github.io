{{/*  ===================================  */}}
{{- with or .Title site.Title | plainify }}
  <meta itemprop="name" content="{{ . }}">
{{- end }}

{{- with or .Params.author site.Params.author site.Params.author.name | plainify }}
  <meta itemprop="author" content="{{ . }}">
  <meta name="author" content="{{ . }}">
{{- end }}

{{- with or .Description .Summary site.Params.description | plainify | htmlUnescape }}
  <meta itemprop="description" content="{{ trim . "\n\r\t " }}">
  <meta name="description" content="{{ trim . "\n\r\t " }}" />
{{- end }}

{{- $ISO8601 := "2006-01-02T15:04:05-07:00" }}
{{- with .PublishDate }}
  <meta itemprop="datePublished" {{ .Format $ISO8601 | printf "content=%q" | safeHTMLAttr }}>
{{- end }}

{{- with .Lastmod }}
  <meta itemprop="dateModified" {{ .Format $ISO8601 | printf "content=%q" | safeHTMLAttr }}>
{{- end }}

{{- with .WordCount }}
  <meta itemprop="wordCount" content="{{ . }}">
{{- end }}

{{- $images := partial "_funcs/get-page-images" . }}
{{- range first 6 $images }}
  <meta itemprop="image" content="{{ .Permalink }}">
{{- end }}

{{- range site.Params.favicons }}
  <link 
    rel="{{ .rel }}" 
    {{ with .type }}type="{{ . }}"{{ end }} 
    {{ with .size }}sizes="{{ . }}"{{ end }} 
    href="{{ .href | absURL }}" 
  />
{{- end }}

{{- /*
Keywords precedence:

1. Use "keywords" term page titles.
2. Use "keywords" from front matter if "keywords" is not a taxonomy.
3. Use "tags" term page titles.
4. Use term page titles from all taxonomies.

*/}}
{{- $keywords := slice }}
{{- range .GetTerms "keywords" }}
  {{- $keywords = $keywords | append .Title }}
{{- else }}
  {{- with .Keywords }}
    {{- $keywords = . }}
  {{- else }}
    {{- range .GetTerms "tags" }}
      {{- $keywords = $keywords | append .Title }}
    {{- else }}
      {{- range $taxonomy, $_ := site.Taxonomies }}
        {{- range $.GetTerms $taxonomy }}
          {{- $keywords = $keywords | append .Title }}
        {{- end }}
      {{- end }}
    {{- end }}
  {{- end }}
{{- end }}
{{- with $keywords }}
  <meta itemprop="keywords" content="{{ delimit . `,` }}">
  <meta name="keywords" content="{{ delimit . `,` }}">
{{- end -}}

{{- with .OutputFormats.Get "rss" }}
  {{ printf `<link rel=%q type=%q href=%q title=%q>` .Rel .MediaType.Type .Permalink site.Title | safeHTML }}
{{- end }}

<link rel="sitemap" type="application/xml" href="{{ "sitemap.xml" | absURL }}" />
<link rel="canonical" href="{{ .Permalink }}" />
<title>{{ if .IsHome }}{{ site.Title }}{{ else }}{{ printf "%s | %s" .Title site.Title }}{{ end }}</title>